{"version":3,"sources":["./src/app/services/appointment.service.ts","./src/app/saved-appointment/saved-appointment.page.html","./src/app/saved-appointment/saved-appointment.page.scss","./src/app/saved-appointment/saved-appointment.page.ts"],"names":[],"mappings":"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","file":"default~appointments-appointments-module~saved-appointment-saved-appointment-module-es2015.js","sourcesContent":["import { Injectable } from '@angular/core';\n//import { LocalNotifications } from '@ionic-native/local-notifications/ngx';\nimport { LocalNotification, LocalNotificationsPlugin, Plugins } from '@capacitor/core';\n//import { LocalNotification, LocalNotificationPendingList, Plugins, } from '@capacitor/core';\nconst { Storage, LocalNotifications } = Plugins;\n\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AppointmentService {\n  public appointments = {};\n  //set the strage key for photos can be changed\n  private APPOINTMENT_STORAGE: string = \"appointment\";\n\n  constructor(\n  ) { }\n\n  async loadAppointment(){\n    // create a promise that load the data from database\n    const appiontmentGet = await Storage.get({ key: this.APPOINTMENT_STORAGE });\n    // set the current session value using data from DB, if it doesn't exist it wll initialize a empty array\n    this.appointments = JSON.parse(appiontmentGet.value) || {};\n    console.log(\"finished loading\");\n    await LocalNotifications.requestPermission();\n  }\n\n  saveValue() {\n    const JSONString = JSON.stringify(this.appointments);\n    // store the value in to the pair\n    Storage.set({\n      key: this.APPOINTMENT_STORAGE,\n      value: JSONString\n    })\n  }\n\n  public async setReminder(appointment:{}, id:number) {\n    const date = appointment[\"appointmentDate\"].slice(0,10);\n    const time = appointment[\"appointmentDate\"].slice(11);\n    const alarm = appointment[\"alarmDateTime\"];\n    const title = appointment[\"title\"];\n    const doctor = appointment[\"doctor\"];\n    const location = appointment[\"location\"];\n\n    const notificationTitle = title;\n    const appointmentDateTime = new Date(appointment['appointmentDate']);\n    const displayTime = time.slice(0, 5)\n    const displayDate = date.slice(8) + '/' + date.slice(5, 7) + '/' + date.slice(0, 4)\n    const notificationText  = \"You have an appointment at \" + displayTime + \" on \" + displayDate + \" with \" + doctor + \" at \" + location;\n    \n    console.log(appointment);\n    console.log(id);\n    const notifs = await LocalNotifications.schedule({\n      notifications: [\n        {\n          title: notificationTitle,\n          body: notificationText,\n          id: id,\n          schedule: { at: new Date(appointmentDateTime.getTime() - alarm) },\n          sound: 'default',\n          attachments: null,\n          actionTypeId: \"\",\n          extra: null,\n        }\n      ]\n    });\n    console.log(LocalNotifications.getPending());\n  }\n}\n","export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-button (click)=\\\"edit()\\\"><ion-icon name=\\\"chevron-back-outline\\\"></ion-icon>Back</ion-button>\\n    </ion-buttons>\\n    <ion-title>Appointments</ion-title>\\n    <ion-buttons slot=\\\"end\\\">\\n      <ion-button color=\\\"danger\\\" (click)=\\\"delete()\\\">Delete</ion-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <ion-card>\\n    <ion-item>\\n      <ion-label>Title:</ion-label>\\n      <ion-label>{{appointment.title}}</ion-label>\\n    </ion-item>\\n\\n    <ion-item>\\n      <ion-label>Doctor:</ion-label>\\n      <ion-label>{{appointment.doctor}}</ion-label>\\n    </ion-item>\\n\\n    <ion-item lines=\\\"none\\\">\\n      <ion-label>Location:</ion-label>\\n      <ion-label>{{appointment.location}}</ion-label>\\n    </ion-item>\\n  </ion-card>\\n\\n  <!-- <div *ngIf='this.appointment.appointmentDate != \\\"Not Set\\\" && this.appointment.appointmentTime != \\\"Not Set\\\"'>  --> \\n    <ion-card>\\n      <ion-item>\\n        <ion-icon name=\\\"calendar-clear-outline\\\" slot=\\\"start\\\"></ion-icon>\\n        <ion-label>Date</ion-label>\\n        <ion-label>{{appointment.appointmentDate  | date : 'd MMM y'}}</ion-label>\\n      </ion-item>\\n\\n      <ion-item lines=\\\"none\\\">\\n        <ion-icon name=\\\"time-outline\\\" slot=\\\"start\\\"></ion-icon>\\n        <ion-label>Time</ion-label>\\n        <ion-label>{{appointment.appointmentDate  | date : 'HH:mm'}}</ion-label>\\n      </ion-item>\\n    </ion-card>\\n\\n    <ion-button id='map' color=\\\"success\\\" expand=\\\"block\\\" (click)=\\\"openMap()\\\">\\n      <ion-icon slot=\\\"start\\\" name=\\\"navigate-circle-outline\\\"></ion-icon>\\n      Show Location on Google Map\\n    </ion-button>\\n\\n<!--     <ion-button color=\\\"danger\\\" expand=\\\"block\\\" (click)=\\\"delete()\\\">\\n      <ion-icon slot=\\\"start\\\" name=\\\"trash-outline\\\"></ion-icon>\\n      <ion-text slot=\\\"end\\\">Delete</ion-text>\\n    </ion-button> -->\\n  <!-- </div> -->\\n\\n</ion-content>\\n\";","export default \"#map {\\n  width: 90%;\\n  margin: auto;\\n  margin-top: 10%;\\n}\\n\\n#delete {\\n  margin-top: 100px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NhdmVkLWFwcG9pbnRtZW50LnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLFVBQUE7RUFDQSxZQUFBO0VBQ0EsZUFBQTtBQUNKOztBQUVBO0VBQ0ksaUJBQUE7QUFDSiIsImZpbGUiOiJzYXZlZC1hcHBvaW50bWVudC5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIjbWFwIHtcbiAgICB3aWR0aDogOTAlO1xuICAgIG1hcmdpbjogYXV0bztcbiAgICBtYXJnaW4tdG9wOiAxMCU7XG59XG5cbiNkZWxldGV7XG4gICAgbWFyZ2luLXRvcDogMTAwcHg7XG59XG4iXX0= */\";","import { Component, Input, OnInit } from '@angular/core';\nimport { ModalController, AlertController } from '@ionic/angular';\nimport { AppointmentReminderPage } from '../appointment-reminder/appointment-reminder.page'\nimport { FormBuilder, FormGroup, FormControl, Validators, ReactiveFormsModule} from '@angular/forms'\n\n//load browser plugin\nimport { Plugins } from '@capacitor/core';\nconst { Browser, LocalNotifications } = Plugins;\n\nimport { AppointmentService } from '../services/appointment.service'; \n\nimport { LoginService } from '../services/login.service'; \nimport { ResourceLoader } from '@angular/compiler';\n\n@Component({\n  selector: 'app-saved-appointment',\n  templateUrl: './saved-appointment.page.html',\n  styleUrls: ['./saved-appointment.page.scss'],\n})\nexport class SavedAppointmentPage implements OnInit {\n  @Input()index:number;\n  public appointment;\n  public form: FormGroup;\n  public appointmentList = [];\n\n  public dateTime;\n\n  constructor(\n    public appointmentService: AppointmentService, \n    public loginService: LoginService,\n    private modalCtrl: ModalController,\n    private alertController: AlertController,\n    public fb: FormBuilder,\n  ) {\n    this.form = this.fb.group({\n      appointmentDate: ['', Validators.required],\n      alarmDateTime: ['', Validators.required],\n      title: ['', Validators.required],\n      location: ['', Validators.required],\n      doctor: ['', Validators.required]\n    })\n  }\n\n  async ngOnInit() {\n    this.appointment = this.appointmentService.appointments[this.index];\n    console.log(this.appointment);\n    Object.keys(this.appointmentService.appointments).forEach(key => {\n      this.appointmentList.push(this.appointmentService.appointments[key])\n    })\n/*     Object.keys(this.form.value).forEach( key => {\n      if( this.appointment[key] != null ){\n        this.form.get(key).setValue(this.appointment[key]);\n        console.log(key, this.appointment[key]);\n      }\n    }) */\n    console.log('saved');\n    console.log('Initiate appointment');\n  }\n\n  async openMap() {\n    const link = \"https://www.google.com/maps/search/?api=1&query=\" + this.appointment[\"location\"]    \n    //console.log(link)\n    const encoded = encodeURI(link)\n    //console.log(encoded)\n    await Browser.open({url: encoded});\n  }\n\n  async edit(){\n/*     this.appointment = {};\n    Object.keys(this.form).forEach( key => {\n      this.appointment[key] = this.form.value[key];\n    })\n    console.log(this.appointmentService.appointments);\n    this.appointmentService.appointments[this.index] = this.appointment;\n    this.appointmentService.saveValue();\n    location.reload(); */\n    this.modalCtrl.dismiss();\n  }\n\n  async delete(){\n    console.log(\"delete appointment\");\n    console.log(LocalNotifications.getPending());\n    this.appointmentList.splice(this.index, 1);\n    this.appointmentService.appointments = {};\n    for(let i=0; i<this.appointmentList.length; i++){\n      this.appointmentService.appointments[i] = this.appointmentList[i];\n    }\n    this.appointmentService.saveValue();\n    location.reload();\n\n    /* const alert = await this.alertController.create({\n      header: 'Delete',\n      message: 'Confirm to delete this appointment.',\n      buttons: [\n        {\n          text: 'Cancel',\n          role: 'cancel',\n          cssClass: 'secondary',\n          handler: (cancel) => {\n            console.log('Confirm Cancel: cancel');\n          }\n        }, {\n          text: 'Delete',\n          handler: (blah) => {\n            console.log(LocalNotifications.getPending());\n            this.appointmentList.splice(this.index, 1);\n            this.appointmentService.appointments = {};\n            for(let i=0; i<this.appointmentList.length; i++){\n              this.appointmentService.appointments[i] = this.appointmentList[i];\n            }\n            this.appointmentService.saveValue();\n            location.reload();\n          }\n        }\n      ]\n    });\n    await alert.present(); */\n  }\n\n}\n"],"sourceRoot":"webpack:///"}